---
title: 200503前端性能优化
comments: true
tags:
  - Html
  - Js
  - 性能优化
categories: Js
date: 2020-05-03 12:07:22
---
# 页面重构怎么操作？
> 在不改变外部行为的前提下，简化结构、添加可读性，而在网站前端保持一致的行为。
> 也就是说是在不改变UI的情况下，对网站进行优化，在扩展的同时保持一致的UI。
1. 表格(table)布局改为DIV+CSS(table代码冗余,且不好控制样式,为了将样式于数据展示分离,最好用div)
使网站前端兼容于现代浏览器(针对于不合规范的CSS、如对IE6有效的)
对于移动平台的优化
针对于SEO进行优化
深层次的网站重构应该考虑的方面

2. 减少代码间的耦合
让代码保持弹性
严格按规范编写代码
设计可扩展的API
代替旧有的框架、语言(如VB)
增强用户体验
通常来说对于速度的优化也包含在重构中

3. 压缩JS、CSS、image等前端资源(通常是由服务器来解决)
程序的性能优化(如数据读写)
采用CDN来加速资源加载
对于JS DOM的优化
HTTP服务器的文件缓存


# 前端性能优化的方法？
1. 减少http请求次数：CSS Sprites, JS、CSS源码压缩、图片大小控制合适；网页Gzip，CDN托管，data缓存 ，图片服务器。
2. 前端模板 JS+数据，减少由于HTML标签导致的带宽浪费，前端用变量保存AJAX请求结果，每次操作本地变量，不用请求，减少请求次数
3.  用innerHTML代替DOM操作，减少DOM操作次数，优化javascript性能。
4.  当需要设置的样式很多时设置className而不是直接操作style。
5.  少用全局变量、缓存DOM节点查找的结果。减少IO读取操作
6.  避免使用CSS Expression（css表达式)又称Dynamic properties(动态属性)。
7.  图片预加载，将样式表放在顶部，将脚本放在底部 加上时间戳。
8.  避免在页面的主体布局中使用table，table要等其中的内容完全下载之后才会显示出来，显示比div+css布局慢。

# 优化思路
在不影响功能和体验的情况下，
1. 能在浏览器执行的不要在服务端执行，
2. 能在缓存服务器上直接返回的不要到应用服务器，
3. 程序能直接取得的结果不要到外部取得，
4. 本机内能取得的数据不要到远程取，
5. 内存能取到的不要到磁盘取，
6. 缓存中有的不要去数据库查询。
7. 减少数据库操作指减少更新次数、缓存结果减少查询次数、将数据库执行的操作尽可能的让你的程序完成（例如join查询），减少磁盘IO指尽量不使用文件系统作为缓存、减少读写文件次数等。
8. 程序优化永远要优化慢的部分，换语言是无法“优化”的。

# 页面从输入 URL 到页面加载显示完成
## 详细版
1. 浏览器会开启一个线程来处理这个请求，对 URL 分析判断如果是 http 协议就按照 Web 方式来处理;
2. 调用浏览器内核中的对应方法，比如 WebView 中的 loadUrl 方法;
3. 通过DNS解析获取网址的IP地址，设置 UA 等信息发出第二个GET请求;
4. 进行HTTP协议会话，客户端发送报头(请求报头);
5. 进入到web服务器上的 Web Server，如 Apache、Tomcat、Node.JS 等服务器;
6. 进入部署好的后端应用，如 PHP、Java、JavaScript、Python 等，找到对应的请求处理;
7. 处理结束回馈报头，此处如果浏览器访问过，缓存上有对应资源，会与服务器最后修改时间对比，一致则返回304;
8. 浏览器开始下载html文档(响应报头，状态码200)，同时使用缓存;
9. 文档树建立，根据标记请求所需指定MIME类型的文件（比如css、js）,同时设置了cookie;
10. 页面开始渲染DOM，JS根据DOM API操作DOM,执行事件绑定等，页面显示完成。

## 简略版
1. 浏览器根据请求的URL交给DNS域名解析，找到真实IP，向服务器发起请求；
2. 服务器交给后台处理完成后返回数据，浏览器接收文件（HTML、JS、CSS、图象等）；
3. 浏览器对加载到的资源（HTML、JS、CSS等）进行语法解析，建立相应的内部数据结构（如HTML的DOM）；
4. 载入解析到的资源文件，渲染页面，完成。

